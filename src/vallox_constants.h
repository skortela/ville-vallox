/*
 * Vallox constants
 *
 */
#ifndef _VALLOX_CONSTANTS_
#define _VALLOX_CONSTANTS_

#include <Arduino.h>
#include <map>


const uint8_t VX_ALL_CLIENTS = 0x20;

const uint8_t VX_DOMAIN = 0x01;
const uint8_t VX_MAINBOARD = 0x11;
const uint8_t VX_REQ_QUERY = 0x00;

const uint8_t VX_PARAM_FAN_RELAYS = 0x06; // read-only! VAARA! useamman kuin yhden bitin muuttaminen ykköseksi polttaa muuntajan!
const uint8_t VX_PARAM_IO_PORT_7 = 0x07; // bit 5, read only
const uint8_t VX_PARAM_IO_PORT_8 = 0x08;
const uint8_t VX_PARAM_HUMIDITY = 0x2a;
const uint8_t VX_PARAM_CO2_HIGHBYTE = 0x2B;
const uint8_t VX_PARAM_CO2_LOWBYTE = 0x2C;
const uint8_t VX_PARAM_SENSORS = 0x2D;
const uint8_t VX_PARAM_FAN_SPEED = 0x29;     // read/write
const uint8_t VX_PARAM_TEMP_OUTDOOR = 0x32;  // ulkoilma
const uint8_t VX_PARAM_TEMP_EXHAUST = 0x33;  // jäteilma
const uint8_t VX_PARAM_TEMP_INSIDE = 0x34;   // poistoilma
const uint8_t VX_PARAM_TEMP_INCOMING = 0x35; // tuloilma
const uint8_t VX_PARAM_LAST_ERRORCODE = 0x36; // vikatilan virhenumero, viimeisen vian numero

const uint8_t VX_PARAM_FLAGS_5 = 0x70; // bitti 7 = etulämmityksen tilalippu, 0 = päällä, 1 = pois
const uint8_t VX_PARAM_FLAGS_6 = 0x71; //

const uint8_t VX_PARAM_TAKKA_COUNTER = 0x79; // TAKKA/TEHOSTUSKYTKIMEN LASKURI, Toiminnon jäljellä oleva aika minuutteina

const uint8_t VX_PARAM_SENDING_ALLOWED = 0x8F;
const uint8_t VX_PARAM_SENDING_DISALLOED = 0x91;

const uint8_t VX_PARAM_LEDS = 0xA3;
const uint8_t VX_PARAM_POST_HEATING = 0xA4; // Jälkilämmityksen kohdearvo NTC-anturin asteikolla.


static std::map<uint8_t, int> g_ntcMap = {
    {0x00, -74}, {0x01, -70}, {0x02, -66}, {0x03, -62}, {0x04, -59}, {0x05, -56}, {0x06, -54}, {0x07, -52}, {0x08, -50}, {0x09, -48}, {0x0a, -47}, {0x0b, -46}, {0x0c, -44}, {0x0d, -43}, {0x0e, -42}, {0x0f, -41}, {0x10, -40}, {0x11, -39}, {0x12, -38}, {0x13, -37}, {0x14, -36}, {0x15, -35}, {0x16, -34}, {0x17, -33}, {0x18, -33}, {0x19, -32}, {0x1a, -31}, {0x1b, -30}, {0x1c, -30}, {0x1d, -29}, {0x1e, -28}, {0x1f, -28}, {0x20, -27}, {0x21, -27}, {0x22, -26}, {0x23, -25}, {0x24, -25}, {0x25, -24}, {0x26, -24}, {0x27, -23}, {0x28, -23}, {0x29, -22}, {0x2a, -22}, {0x2b, -21}, {0x2c, -21}, {0x2d, -20}, {0x2e, -20}, {0x2f, -19}, {0x30, -19}, {0x31, -19}, {0x32, -18}, {0x33, -18}, {0x34, -17}, {0x35, -17}, {0x36, -16}, {0x37, -16}, {0x38, -16}, {0x39, -15}, {0x3a, -15}, {0x3b, -14}, {0x3c, -14}, {0x3d, -14}, {0x3e, -13}, {0x3f, -13}, {0x40, -12}, {0x41, -12}, {0x42, -12}, {0x43, -11}, {0x44, -11}, {0x45, -11}, {0x46, -10}, {0x47, -10}, {0x48, -9}, {0x49, -9}, {0x4a, -9}, {0x4b, -8}, {0x4c, -8}, {0x4d, -8}, {0x4e, -7}, {0x4f, -7}, {0x50, -7}, {0x51, -6}, {0x52, -6}, {0x53, -6}, {0x54, -5}, {0x55, -5}, {0x56, -5}, {0x57, -4}, {0x58, -4}, {0x59, -4}, {0x5a, -3}, {0x5b, -3}, {0x5c, -3}, {0x5d, -2}, {0x5e, -2}, {0x5f, -2}, {0x60, -1}, {0x61, -1}, {0x62, -1}, {0x63, -1}, {0x64, 0}, {0x65, 0}, {0x66, 0}, {0x67, 1}, {0x68, 1}, {0x69, 1}, {0x6a, 2}, {0x6b, 2}, {0x6c, 2}, {0x6d, 3}, {0x6e, 3}, {0x6f, 3}, {0x70, 4}, {0x71, 4}, {0x72, 4}, {0x73, 5}, {0x74, 5}, {0x75, 5}, {0x76, 5}, {0x77, 6}, {0x78, 6}, {0x79, 6}, {0x7a, 7}, {0x7b, 7}, {0x7c, 7}, {0x7d, 8}, {0x7e, 8}, {0x7f, 8}, {0x80, 9}, {0x81, 9}, {0x82, 9}, {0x83, 10}, {0x84, 10}, {0x85, 10}, {0x86, 11}, {0x87, 11}, {0x88, 11}, {0x89, 12}, {0x8a, 12}, {0x8b, 12}, {0x8c, 13}, {0x8d, 13}, {0x8e, 13}, {0x8f, 14}, {0x90, 14}, {0x91, 14}, {0x92, 15}, {0x93, 15}, {0x94, 15}, {0x95, 16}, {0x96, 16}, {0x97, 16}, {0x98, 17}, {0x99, 17}, {0x9a, 18}, {0x9b, 18}, {0x9c, 18}, {0x9d, 19}, {0x9e, 19}, {0x9f, 19}, {0xa0, 20}, {0xa1, 20}, {0xa2, 21}, {0xa3, 21}, {0xa4, 21}, {0xa5, 22}, {0xa6, 22}, {0xa7, 22}, {0xa8, 23}, {0xa9, 23}, {0xaa, 24}, {0xab, 24}, {0xac, 24}, {0xad, 25}, {0xae, 25}, {0xaf, 26}, {0xb0, 26}, {0xb1, 27}, {0xb2, 27}, {0xb3, 27}, {0xb4, 28}, {0xb5, 28}, {0xb6, 29}, {0xb7, 29}, {0xb8, 30}, {0xb9, 30}, {0xba, 31}, {0xbb, 31}, {0xbc, 32}, {0xbd, 32}, {0xbe, 33}, {0xbf, 33}, {0xc0, 34}, {0xc1, 34}, {0xc2, 35}, {0xc3, 35}, {0xc4, 36}, {0xc5, 36}, {0xc6, 37}, {0xc7, 37}, {0xc8, 38}, {0xc9, 38}, {0xca, 39}, {0xcb, 40}, {0xcc, 40}, {0xcd, 41}, {0xce, 41}, {0xcf, 42}, {0xd0, 43}, {0xd1, 43}, {0xd2, 44}, {0xd3, 45}, {0xd4, 45}, {0xd5, 46}, {0xd6, 47}, {0xd7, 48}, {0xd8, 48}, {0xd9, 49}, {0xda, 50}, {0xdb, 51}, {0xdc, 52}, {0xdd, 53}, {0xde, 53}, {0xdf, 54}, {0xe0, 55}, {0xe1, 56}, {0xe2, 57}, {0xe3, 59}, {0xe4, 60}, {0xe5, 61}, {0xe6, 62}, {0xe7, 63}, {0xe8, 65}, {0xe9, 66}, {0xea, 68}, {0xeb, 69}, {0xec, 71}, {0xed, 73}, {0xee, 75}, {0xef, 77}, {0xf0, 79}, {0xf1, 81}, {0xf2, 82}, {0xf3, 86}, {0xf4, 90}, {0xf5, 93}, {0xf6, 97}, {0xf7, 100}, {0xf8, 100}, {0xf9, 100}, {0xfa, 100}, {0xfb, 100}, {0xfc, 100}, {0xfd, 100}, {0xfe, 100}, {0xff, 100}
};

static std::map<uint8_t, int> g_fanSpeed = {
    {0x01, 1},
    {0x03, 2},
    {0x07, 3},
    {0x0f, 4},
    {0x1f, 5},
    {0x3f, 6},
    {0x7f, 7},
    {0xff, 8}
};


struct _vallox_packet {
    uint8_t domain;
    uint8_t sender;
    uint8_t receiver;
    uint8_t param;
    uint8_t data;
    uint8_t checksum;
};

#endif // _VALLOX_CONSTANTS_
